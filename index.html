<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… IPS Ø§Ù„Ù…Ø·ÙˆØ± - Ø§Ø¨Ù† Ø®Ù„Ø¯ÙˆÙ†</title>
    <style>
        :root { --primary: #8e44ad; --bg: #f4f7fe; --sidebar-w: 260px; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; }
        .auth-screen { position: fixed; inset: 0; background: white; z-index: 2000; display: flex; align-items: center; justify-content: center; overflow-y: auto; padding: 20px; }
        .auth-card { width: 100%; max-width: 450px; background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); text-align: center; }
        input, select { width: 100%; padding: 12px; margin: 5px 0; border: 1px solid #ddd; border-radius: 10px; box-sizing: border-box; }
        .btn-main { background: var(--primary); color: white; border: none; padding: 14px; width: 100%; border-radius: 12px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .app-container { display: none; min-height: 100vh; width: 100%; }
        .sidebar { width: var(--sidebar-w); background: white; border-left: 1px solid #eee; padding: 20px; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; }
        .main-content { flex-grow: 1; padding: 20px; }
        .card { background: white; border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 10px; margin-top: 15px; }
        .info-item { background: #f8f9ff; padding: 10px; border-radius: 10px; border: 1px solid #ecefff; }
        .info-label { font-size: 11px; color: #888; display: block; }
        @media (max-width: 768px) { .app-container { flex-direction: column; } .sidebar { width: 100%; } }
    </style>
</head>
<body>

<div id="auth-screen" class="auth-screen">
    <div id="login-box" class="auth-card">
        <img src="1000219663.jpg" style="width:100px;">
        <h2 style="color:var(--primary); margin:0;">IPS</h2>
        <input type="text" id="user-in" placeholder="ID Ø§Ù„Ø·Ø§Ù„Ø¨ Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¬Ù‡">
        <input type="password" id="pass-in" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
        <button class="btn-main" onclick="handleLogin()">Ø¯Ø®ÙˆÙ„</button>
        <p style="cursor:pointer; color:var(--primary); font-size:13px; margin-top:15px;" onclick="toggleAuth(true)">Ø£Ù„Ø§ ØªÙ…Ù„Ùƒ Ø­Ø³Ø§Ø¨ØŸ Ø³Ø¬Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø¢Ù†</p>
    </div>

    <div id="register-box" class="auth-card" style="display:none;">
        <h3 style="color:var(--primary)">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <input type="text" id="reg-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
            <input type="text" id="reg-id" placeholder="ID Ø§Ù„Ø·Ø§Ù„Ø¨">
            <input type="text" id="reg-father" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ø¨">
            <input type="text" id="reg-mother" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£Ù…">
            <input type="date" id="reg-dob" title="ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯">
            <input type="text" id="reg-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
            <input type="tel" id="reg-fPhone" placeholder="Ù‡Ø§ØªÙ Ø§Ù„Ø£Ø¨">
            <input type="tel" id="reg-mPhone" placeholder="Ù‡Ø§ØªÙ Ø§Ù„Ø£Ù…">
            <select id="reg-grade"><option>ØªØ§Ø³Ø¹</option><option>Ø«Ø§Ù„Ø« Ø«Ø§Ù†ÙˆÙŠ</option></select>
            <input type="text" id="reg-section" placeholder="Ø§Ù„Ø´Ø¹Ø¨Ø©">
        </div>
        <input type="password" id="reg-pass" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±">
        <button class="btn-main" onclick="handleRegister()">Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„</button>
        <p onclick="toggleAuth(false)" style="cursor:pointer; color:#666; font-size:12px; margin-top:10px;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø¯Ø®ÙˆÙ„</p>
    </div>
</div>

<div id="main-app" class="app-container">
    <div class="sidebar">
        <img src="1000219663.jpg" style="width:60px; margin-bottom:15px;">
        <h3 id="side-name">---</h3>
        <p id="side-id" style="color:#888; font-size:12px;">ID: ---</p>
        <div style="width:100%; margin-top:20px;">
            <div style="padding:12px; background:#f0edff; color:var(--primary); border-radius:10px; cursor:pointer;" onclick="showTab('profile')">ğŸ‘¤ Ù…Ù„ÙØ§ØªÙŠ</div>
            <div id="admin-only-btn" style="display:none; padding:12px; color:#f39c12; cursor:pointer; font-weight:bold;" onclick="showTab('admin')">ğŸ›  Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙˆØ¬Ù‡</div>
        </div>
        <button onclick="location.reload()" style="margin-top:auto; width:100%; padding:10px; background:#ff7675; color:white; border:none; border-radius:10px;">Ø®Ø±ÙˆØ¬</button>
    </div>

    <div class="main-content">
        <div id="tab-profile" class="card">
            <h3 id="profile-title">Ø¨ÙŠØ§Ù†Ø§ØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>
            <div id="profile-info" class="info-grid"></div>
        </div>

        <div id="tab-admin" class="card" style="display:none; border:2px solid #f39c12;">
            <h3>ğŸ›  Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù‡Ø¯ ÙˆØ±ØµØ¯ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª</h3>
            <div class="card" style="background:#fffcf5;">
                <h4>ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬Ù‡</h4>
                <input type="text" id="adm-name-edit" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¬Ù‡">
                <input type="text" id="adm-role-edit" placeholder="Ø§Ù„Ù…Ù†ØµØ¨ (Ù…Ø«Ù„Ø§Ù‹: Ù…ÙˆØ¬Ù‡ Ø¹Ø§Ù…)">
                <button class="btn-main" style="background:#f39c12;" onclick="saveAdminInfo()">Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙŠ ÙƒÙ…ÙˆØ¬Ù‡</button>
            </div>
            <h4>Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†:</h4>
            <div id="admin-students-list"></div>
        </div>
    </div>
</div>

<script>
    let students = JSON.parse(localStorage.getItem('ips_db')) || [];
    let adminInfo = JSON.parse(localStorage.getItem('ips_admin')) || { name: "Ø§Ø¨Ù† Ø®Ù„Ø¯ÙˆÙ†", role: "Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø¹Ø§Ù…" };

    function toggleAuth(isReg) {
        document.getElementById('login-box').style.display = isReg ? 'none' : 'block';
        document.getElementById('register-box').style.display = isReg ? 'block' : 'none';
    }

    function handleRegister() {
        const data = {
            name: document.getElementById('reg-name').value,
            id: document.getElementById('reg-id').value,
            father: document.getElementById('reg-father').value,
            mother: document.getElementById('reg-mother').value,
            dob: document.getElementById('reg-dob').value,
            address: document.getElementById('reg-address').value,
            fPhone: document.getElementById('reg-fPhone').value,
            mPhone: document.getElementById('reg-mPhone').value,
            grade: document.getElementById('reg-grade').value,
            section: document.getElementById('reg-section').value,
            pass: document.getElementById('reg-pass').value,
            math: 0, sci: 0
        };

        if(!data.name || !data.id || !data.pass) return alert("Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù€ ID ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø£Ø³Ø§Ø³ÙŠØ©!");
        students.push(data);
        localStorage.setItem('ips_db', JSON.stringify(students));
        alert("ØªÙ… Ø­ÙØ¸ Ù…Ù„ÙÙƒ Ø¨Ù†Ø¬Ø§Ø­!");
        toggleAuth(false);
    }

    function handleLogin() {
        const u = document.getElementById('user-in').value;
        const p = document.getElementById('pass-in').value;

        if(u === "ibn khaldon" && p === "ITmohammedf0@") {
            loadApp(adminInfo.name, "ADMIN", true);
        } else {
            const st = students.find(s => s.id === u && s.pass === p);
            if(st) loadApp(st.name, st.id, false, st);
            else alert("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
        }
    }

    function loadApp(name, id, isAdmin, stData = null) {
        document.getElementById('auth-screen').style.display = 'none';
        document.getElementById('main-app').style.display = 'flex';
        document.getElementById('side-name').innerText = name;
        document.getElementById('side-id').innerText = "ID: " + id;

        if(isAdmin) {
            document.getElementById('admin-only-btn').style.display = 'block';
            document.getElementById('adm-name-edit').value = adminInfo.name;
            document.getElementById('adm-role-edit').value = adminInfo.role;
            renderAdminView();
            showTab('admin');
        } else {
            renderProfile(stData);
            showTab('profile');
        }
    }

    function renderProfile(st) {
        const grid = document.getElementById('profile-info');
        const fields = { name: "Ø§Ù„Ø§Ø³Ù…", father: "Ø§Ù„Ø£Ø¨", mother: "Ø§Ù„Ø£Ù…", dob: "Ø§Ù„Ù…ÙˆØ§Ù„ÙŠØ¯", address: "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†", fPhone: "Ù‡Ø§ØªÙ Ø§Ù„Ø£Ø¨", mPhone: "Ù‡Ø§ØªÙ Ø§Ù„Ø£Ù…", grade: "Ø§Ù„ØµÙ", section: "Ø§Ù„Ø´Ø¹Ø¨Ø©" };
        grid.innerHTML = "";
        for(let k in fields) {
            grid.innerHTML += `<div class="info-item"><span class="info-label">${fields[k]}</span><b>${st[k] || '-'}</b></div>`;
        }
    }

    function saveAdminInfo() {
        adminInfo.name = document.getElementById('adm-name-edit').value;
        adminInfo.role = document.getElementById('adm-role-edit').value;
        localStorage.setItem('ips_admin', JSON.stringify(adminInfo));
        document.getElementById('side-name').innerText = adminInfo.name;
        alert("ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¬Ù‡");
    }

    function showTab(tab) {
        document.getElementById('tab-profile').style.display = tab === 'profile' ? 'block' : 'none';
        document.getElementById('tab-admin').style.display = tab === 'admin' ? 'block' : 'none';
    }

    function renderAdminView() {
        const list = document.getElementById('admin-students-list');
        list.innerHTML = students.map(s => `<div style="padding:10px; border-bottom:1px solid #eee;">${s.name} - ${s.grade}</div>`).join('');
    }
</script>
</body>
</html>
